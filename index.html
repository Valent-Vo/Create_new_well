<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Создание скважины на сервере Лукойл</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uikit@3.11.2/dist/css/uikit.min.css" />
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Helvetica", "Arial", sans-serif;
            margin: 20px;
            background-color: #f4f4f9;
        }
        h1 {
            text-align: center;
            font-size: 18px;
            margin-bottom: 20px;
        }
        .container {
            margin-bottom: 20px;
        }
        .email-preview {
            border: 1px solid #ccc;
            padding: 10px;
            margin-bottom: 30px;
        }
        .email-preview textarea {
            width: 100%;
            height: 150px;
            margin-bottom: 10px;
        }
        .email-preview button {
            display: block;
            margin: 10px auto;
        }
    </style>
</head>
<body>

    <h1>Создание скважины на сервере Лукойл</h1>

    <div class="container">
        <label for="well">Скважина:</label>
        <input type="text" id="well" placeholder="Введите имя скважины" oninput="generateEmail()">
    </div>

    <div class="container">
        <label for="location">Месторождение:</label>
        <select id="location" onchange="generateEmail()">
            <option value="Курраганский">Курраганский</option>
            <option value="Лас-Еганский">Лас-Еганский</option>
            <option value="Имилорский">Имилорский</option>
            <option value="Южно-Ягунский">Южно-Ягунский</option>
            <option value="Тевлинско-Русскинской">Тевлинско-Русскинской</option>
            <option value="Кочевской">Кочевской</option>
            <option value="Ватьеганский">Ватьеганский</option>
            <option value="Покачевский">Покачевский</option>
            <option value="Кечимовский">Кечимовский</option>
            <option value="Мишаевский">Мишаевский</option>
            <option value="Северо-Покачевский">Северо-Покачевский</option>
            <option value="Восточно-Янчинский">Восточно-Янчинский</option>
            <option value="Пякяхинский">Пякяхинский</option>
            <option value="Яхлинский">Яхлинский</option>
            <option value="Локосовский">Локосовский</option>
            <option value="Нонг-Еганский">Нонг-Еганский</option>
            <option value="Повховский">Повховский</option>
            <option value="Кустовой">Кустовой</option>
            <option value="Марталлеровский">Марталлеровский</option>
            <option value="Северо-Ягунский">Северо-Ягунский</option>
            <option value="Северо-Когалымский">Северо-Когалымский</option>
            <option value="Северо-Кочевской">Северо-Кочевской</option>
            <option value="Западно-Тазовский">Западно-Тазовский</option>
            <option value="Нивагальский">Нивагальский</option>
            <option value="Пайтыхский">Пайтыхский</option>
            <option value="Даниловский">Даниловский</option>
            <option value="Южно-Покачеевский">Южно-Покачеевский</option>
            <option value="Восточно-Икилорский">Восточно-Икилорский</option>
        </select>
    </div>

    <div class="container">
        <label for="start-date">Дата и время начала строительства скважины:</label>
        <input type="datetime-local" id="start-date" onchange="generateEmail()">
    </div>

    <div class="container">
        <label for="area">Область:</label>
        <select id="area" onchange="generateEmail()">
            <option value="ХМАО">ХМАО</option>
            <option value="ЯНАО">ЯНАО</option>
        </select>
    </div>

    <div class="container">
        <label for="customer-company">Компания-заказчик:</label>
        <input type="text" id="customer-company" value="ООО 'ЛУКОЙЛ-Западная Сибирь'" readonly>
    </div>

    <div class="container">
        <label for="customer-department">Подразделение заказчика:</label>
        <select id="customer-department" onchange="generateEmail()">
            <option value="ТПП 'Покачевнефтегаз'">ТПП "Покачевнефтегаз"</option>
            <option value="ТПП 'Когалымнефтегаз'">ТПП "Когалымнефтегаз"</option>
            <option value="ТПП 'Лангепаснефтегаз'">ТПП "Лангепаснефтегаз"</option>
            <option value="ТПП 'Ямалнефтегаз'">ТПП "Ямалнефтегаз"</option>
        </select>
    </div>

    <div class="container">
        <label for="license-area">Лицензионный участок:</label>
        <select id="license-area" onchange="generateEmail()">
            <option value="Курраганский">Курраганский</option>
            <option value="Лас-Еганский">Лас-Еганский</option>
            <option value="Имилорский">Имилорский</option>
            <option value="Южно-Ягунский">Южно-Ягунский</option>
            <option value="Тевлинско-Русскинской">Тевлинско-Русскинской</option>
            <option value="Кочевской">Кочевской</option>
            <option value="Ватьеганский">Ватьеганский</option>
            <option value="Покачевский">Покачевский</option>
            <option value="Кечимовский">Кечимовский</option>
            <option value="Мишаевский">Мишаевский</option>
            <option value="Северо-Покачевский">Северо-Покачевский</option>
            <option value="Восточно-Янчинский">Восточно-Янчинский</option>
            <option value="Пякяхинский">Пякяхинский</option>
            <option value="Яхлинский">Яхлинский</option>
            <option value="Локосовский">Локосовский</option>
            <option value="Нонг-Еганский">Нонг-Еганский</option>
            <option value="Повховский">Повховский</option>
            <option value="Кустовой">Кустовой</option>
            <option value="Марталлеровский">Марталлеровский</option>
            <option value="Северо-Ягунский">Северо-Ягунский</option>
            <option value="Северо-Когалымский">Северо-Когалымский</option>
            <option value="Северо-Кочевской">Северо-Кочевской</option>
            <option value="Западно-Тазовский">Западно-Тазовский</option>
            <option value="Нивагальский">Нивагальский</option>
            <option value="Пайтыхский">Пайтыхский</option>
            <option value="Даниловский">Даниловский</option>
            <option value="Южно-Покачеевский">Южно-Покачеевский</option>
            <option value="Восточно-Икилорский">Восточно-Икилорский</option>
        </select>
    </div>

    <!-- Добавьте дополнительные поля, если необходимо -->

    <div class="email-preview">
        <h2 style="text-align: center; font-size: 18px;">Предпросмотр письма</h2>
        <textarea id="email-preview" readonly></textarea>
        <button onclick="copyToClipboard()">Скопировать текст</button>
    </div>

    <div class="container">
        <h3>Копия письма</h3>
        <label><input type="checkbox" id="moshkin" checked> Константин Мошкин</label><br>
        <label><input type="checkbox" id="voynilenko" checked> Валентин Войниленко</label><br>
        <label><input type="checkbox" id="kaverzin" checked> Владимир Каверзин</label>
    </div>

    <div class="container">
        <button onclick="generateOutlookEmail()">Сформировать письмо</button>
    </div>

    <script>
        function generateEmail() {
            const well = document.getElementById('well').value;
            const location = document.getElementById('location').value;
            const startDate = document.getElementById('start-date').value;
            const area = document.getElementById('area').value;
            const department = document.getElementById('customer-department').value;
            const licenseArea = document.getElementById('license-area').value;

            let emailBody = `
Добрый день, коллеги!
Прошу создать скважину в GОreport на сервере Лукойл-Западная Сибирь
Проверьте, пожалуйста, на наличие дубликатов скважины перед созданием. А также чтобы она находилась вместе со скважиной ${well} в репорте.

Дата и время начала строительства скважины (ориентировочная): ${startDate}
Область: ${area}
Компания-заказчик: ООО "ЛУКОЙЛ-Западная Сибирь"
Подразделение заказчика: ${department}
Месторождение: ${location}
Лицензионный участок: ${licenseArea}

Спасибо!
`;

            document.getElementById('email-preview').value = emailBody;
        }

        function copyToClipboard() {
            const emailPreview = document.getElementById('email-preview');
            emailPreview.select();
            document.execCommand('copy');
        }

        function generateOutlookEmail() {
            const emailBody = document.getElementById('email-preview').value;
            const subject = `Создание скважины ${document.getElementById('well').value} на сервере`;
            const recipients = 'support@geosteering.ru';
            
            const ccEmails = [];
            if (document.getElementById('moshkin').checked) ccEmails.push('kmoshkin@geosteering.ru');
            if (document.getElementById('voynilenko').checked) ccEmails.push('vvoynilenko@geosteering.ru');
            if (document.getElementById('kaverzin').checked) ccEmails.push('vkaverzin@geosteering.ru');
            
            const cc = ccEmails.length > 0 ? `&cc=${ccEmails.join(',')}` : '';
            window.location.href = `mailto:${recipients}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(emailBody)}${cc}`;
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/uikit@3.11.2/dist/js/uikit.min.js"></script>
</body>
</html>
